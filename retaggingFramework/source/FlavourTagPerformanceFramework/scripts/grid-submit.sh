#!/usr/bin/env bash

if [[ $- == *i* ]] ; then
    echo "Don't source me!" >&2
    return 1
else
    set -eu
fi

ZIPFILE=job.tar
if [[ -f $ZIPFILE ]] ; then
    rm $ZIPFILE
fi

SCRIPT_DIR=$(dirname $BASH_SOURCE)

#choose the joboptions file you want to use
JO=jobOptions.py


# list all the datasets you want to run over here
DSS=(
mc16_13TeV:mc16_13TeV.503822.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_0p01ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
mc16_13TeV:mc16_13TeV.503822.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_0p01ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
mc16_13TeV:mc16_13TeV.503822.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_0p01ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
mc16_13TeV:mc16_13TeV.503823.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_0p1ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
mc16_13TeV:mc16_13TeV.503823.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_0p1ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
mc16_13TeV:mc16_13TeV.503823.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_0p1ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
mc16_13TeV:mc16_13TeV.503824.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_1ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
mc16_13TeV:mc16_13TeV.503824.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_1ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
mc16_13TeV:mc16_13TeV.503824.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_1ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
mc16_13TeV:mc16_13TeV.503825.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_10ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
mc16_13TeV:mc16_13TeV.503825.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_10ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
mc16_13TeV:mc16_13TeV.503825.MGPy8EG_A14NNPDF23LO_GG_rpvHF_1100_200_10ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
mc16_13TeV:mc16_13TeV.503767.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_0p01ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
mc16_13TeV:mc16_13TeV.503767.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_0p01ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
mc16_13TeV:mc16_13TeV.503767.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_0p01ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
mc16_13TeV:mc16_13TeV.503768.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_0p1ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
mc16_13TeV:mc16_13TeV.503768.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_0p1ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
mc16_13TeV:mc16_13TeV.503768.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_0p1ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
mc16_13TeV:mc16_13TeV.503769.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_1ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
mc16_13TeV:mc16_13TeV.503769.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_1ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
mc16_13TeV:mc16_13TeV.503769.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_1ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
mc16_13TeV:mc16_13TeV.503770.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_10ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
mc16_13TeV:mc16_13TeV.503770.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_10ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
mc16_13TeV:mc16_13TeV.503770.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_10ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
mc16_13TeV:mc16_13TeV.503771.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_100ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
mc16_13TeV:mc16_13TeV.503771.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_100ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
mc16_13TeV:mc16_13TeV.503771.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_100ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
)
#mc16_13TeV:mc16_13TeV.503767.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_0p01ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
#mc16_13TeV:mc16_13TeV.503767.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_0p01ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
#mc16_13TeV:mc16_13TeV.503767.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_0p01ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
#mc16_13TeV:mc16_13TeV.503768.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_0p1ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
#mc16_13TeV:mc16_13TeV.503768.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_0p1ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
#mc16_13TeV:mc16_13TeV.503768.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_0p1ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
#mc16_13TeV:mc16_13TeV.503769.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_1ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
#mc16_13TeV:mc16_13TeV.503769.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_1ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
#mc16_13TeV:mc16_13TeV.503769.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_1ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
#mc16_13TeV:mc16_13TeV.503770.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_10ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
#mc16_13TeV:mc16_13TeV.503770.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_10ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
#mc16_13TeV:mc16_13TeV.503770.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_10ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
#mc16_13TeV:mc16_13TeV.503771.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_100ns.deriv.DAOD_FTAG1.e8342_s3126_r10201_p4060
#mc16_13TeV:mc16_13TeV.503771.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_100ns.deriv.DAOD_FTAG1.e8342_s3126_r10724_p4060
#mc16_13TeV:mc16_13TeV.503771.MGPy8EG_A14NNPDF23LO_GG_rpvLF_1100_200_100ns.deriv.DAOD_FTAG1.e8342_s3126_r9364_p4060
#)
#mc16_13TeV:mc16_13TeV.410472.PhPy8EG_A14_ttbar_hdamp258p75_dil.deriv.DAOD_FTAG2.e6348_a875_r10724_p4060
#mc16_13TeV:mc16_13TeV.410482.PhPy8EG_A14_ttbar_hdamp517p5_dil.deriv.DAOD_FTAG2.e6454_a875_r10724_p4060

#mc16_13TeV.411356.PhPy8EG_A14_ttbar_hdamp345_SingleLep.deriv.DAOD_FTAG2.e7887_e7400_a875_r10724_r10726_p4060

#mc16_13TeV:mc16_13TeV.412116.aMcAtNloHerwig7EvtGen_MEN30NLO_ttbar_SingleLep.deriv.DAOD_FTAG1.e7620_a875_r10724_p4062
#mc16_13TeV.410470.PhPy8EG_A14_ttbar_hdamp258p75_nonallhad.deriv.DAOD_FTAG2.e6337_e5984_a875_r10724_r10726_p4060_tid32240064_00
#mc16_13TeV.410470.PhPy8EG_A14_ttbar_hdamp258p75_nonallhad.deriv.DAOD_FTAG2.e6337_e5984_a875_r10724_r10726_p4060_tid32238643_00
#mc16_13TeV:mc16_13TeV.410470.PhPy8EG_A14_ttbar_hdamp258p75_nonallhad.deriv.DAOD_FTAG2.e6337_e5984_a875_r10201_r10210_p4060
#mc16_13TeV:mc16_13TeV.410470.PhPy8EG_A14_ttbar_hdamp258p75_nonallhad.deriv.DAOD_FTAG2.e6337_e5984_a875_r9364_r9315_p4060
#mc16_13TeV.410480.PhPy8EG_A14_ttbar_hdamp517p5_SingleLep.deriv.DAOD_FTAG2.e6454_a875_r10724_p4060
#mc16_13TeV.410470.PhPy8EG_A14_ttbar_hdamp258p75_nonallhad.deriv.DAOD_FTAG2.e6337_a875_r10724_p4060

for DS in ${DSS[*]}; do
    ${SCRIPT_DIR}/ftag-grid-sub.sh -j $JO -d $DS -z job.tar
done

##### flags for the ftag-grid-sub.sh script #####
#  -h: get help
#  -n <number>: n files to use (default all)
#  -j <python script>: jobOptions to use (default ${JO})
#  -d <dataset>: input dataset to use (default ${DS})
#  -t <tag>: tag for output dataset
#  -z <file>: create / submit a gziped tarball
#  -u: upload local json files
#  -e: test run, just echo command
#  -f: force submit even if uncommited changes exist
#  -p <number>: nfiles per job (default ${N_FILES_PER_JOB})
